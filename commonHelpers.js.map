{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_API_KEY = '44431480-fc282bb92f0a21d0f4ab058ec';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, per_page = 15) {\n  const url = `${BASE_URL}?key=${PIXABAY_API_KEY}&q=${encodeURIComponent(\n    query\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${per_page}`;\n  try {\n    const response = await axios.get(url);\n    return response.data;\n  } catch (error) {\n    console.error('Fetch error:', error);\n    throw new Error(`Failed to fetch images: ${error.message}`);\n  }\n}\n","export function renderImages(images, container, isNewQuery) {\n  if (isNewQuery) {\n    container.innerHTML = '';\n  }\n\n  const galleryHTML = images\n    .map(\n      image => `\n    <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n      <figcaption class=\"image-info\">\n        <div class=\"info-container\">\n          <div class=\"info-block\">\n            <strong>Likes</strong>\n            <span>${image.likes}</span>\n          </div>\n          <div class=\"info-block\">\n            <strong>Views</strong>\n            <span>${image.views}</span>\n          </div>\n          <div class=\"info-block\">\n            <strong>Comments</strong>\n            <span>${image.comments}</span>\n          </div>\n          <div class=\"info-block\">\n            <strong>Downloads</strong>\n            <span>${image.downloads}</span>\n          </div>\n        </div>\n      </figcaption>\n    </a>\n  `\n    )\n    .join('');\n\n  container.insertAdjacentHTML('beforeend', galleryHTML);\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderImages } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchForm = document.getElementById('search-form');\n  const galleryContainer = document.getElementById('gallery');\n  const loader = document.getElementById('loader');\n  const loadMoreButton = document.getElementById('load-more');\n  const loadMoreLoader = document.getElementById('load-more-loader');\n  let lightbox;\n  let currentPage = 1;\n  let currentQuery = '';\n  let imagesLoaded = false;\n\n  function skipOldElement() {\n    const liElem = galleryContainer.children[0];\n    if (liElem) {\n      const height = liElem.getBoundingClientRect().height;\n      scrollBy({\n        top: height * 3,\n        behavior: 'smooth',\n      });\n    }\n  }\n\n  if (searchForm) {\n    searchForm.addEventListener('submit', async event => {\n      event.preventDefault();\n      currentQuery = document.getElementById('search-query').value.trim();\n      currentPage = 1;\n      if (!currentQuery) {\n        showError('Please enter a search query');\n        return;\n      }\n      await fetchAndRenderImages(true);\n    });\n  } else {\n    console.error('Search form not found');\n  }\n\n  if (loadMoreButton) {\n    loadMoreButton.addEventListener('click', async () => {\n      currentPage += 1;\n      loadMoreLoader.classList.add('load-more-loader-show');\n      await fetchAndRenderImages(false);\n    });\n  } else {\n    console.error('Load more button not found');\n  }\n\n  async function fetchAndRenderImages(isNewQuery) {\n    try {\n      if (isNewQuery) {\n        loader.classList.add('loader-show');\n        galleryContainer.innerHTML = '';\n        loadMoreButton.style.display = 'none';\n        imagesLoaded = false;\n      }\n      const data = await fetchImages(currentQuery, currentPage);\n      const { hits: images, totalHits } = data;\n      if (images.length === 0 && currentPage === 1) {\n        showError(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      } else {\n        renderImages(images, galleryContainer, isNewQuery);\n        if (lightbox) {\n          lightbox.refresh();\n        } else {\n          lightbox = new SimpleLightbox('.gallery a', {\n            captions: false,\n            closeText: 'Ã—',\n            history: false,\n          });\n        }\n        if (currentPage * 9 >= totalHits) {\n          loadMoreButton.style.display = 'none';\n          showError(\n            \"We're sorry, but you've reached the end of search results.\"\n          );\n        } else {\n          loadMoreButton.style.display = 'block';\n        }\n        if (imagesLoaded) {\n          skipOldElement();\n        } else {\n          imagesLoaded = true;\n        }\n      }\n    } catch (error) {\n      showError('Failed to fetch images. Please try again later.');\n    } finally {\n      loader.classList.remove('loader-show');\n      loadMoreLoader.classList.remove('load-more-loader-show');\n    }\n  }\n\n  function showError(message) {\n    iziToast.error({\n      message: message,\n      position: 'topRight',\n      timeout: 5000,\n      messageColor: '#fff',\n      backgroundColor: '#EF4040',\n      theme: 'dark',\n      icon: 'none',\n    });\n  }\n});\n"],"names":["PIXABAY_API_KEY","BASE_URL","fetchImages","query","page","per_page","url","axios","error","renderImages","images","container","isNewQuery","galleryHTML","image","searchForm","galleryContainer","loader","loadMoreButton","loadMoreLoader","lightbox","currentPage","currentQuery","imagesLoaded","skipOldElement","liElem","height","event","showError","fetchAndRenderImages","data","totalHits","SimpleLightbox","message","iziToast"],"mappings":"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"}